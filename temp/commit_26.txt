Implement authentication middleware - Implementation details
